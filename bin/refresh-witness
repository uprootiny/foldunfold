#!/bin/bash
# Refresh witness data periodically
# Run via cron: */5 * * * * /home/uprootiny/repos/foldunfold/bin/refresh-witness

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
cd "$SCRIPT_DIR"

# Generate fresh witness data with consolidated script
./witness > /tmp/witness.edn 2>/dev/null

if [ $? -eq 0 ] && [ -s /tmp/witness.edn ]; then
    cp /tmp/witness.edn /var/www/drops/foldunfold/api/witness
    chmod 644 /var/www/drops/foldunfold/api/witness
fi
